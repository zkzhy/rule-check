# 设计：Eino 组件化结构优化

## 背景与动机
本次变更旨在基于 Eino 的组件化思路优化项目结构。用户提到的 “skiil” 更符合 “Skill/Tool（技能/工具）” 的语义，即将可复用能力按 Tool 方式组织；同时希望清理冗余产物并提升目录层级的严谨性与扩展性。

## 架构调整

### 1) 将 Taxonomy 作为 Tool 组件
- **现状**：`internal/taxonomy` 是一个独立包，位置不贴合 “工具能力” 的语义。
- **调整后**：迁移为 `internal/components/tools/taxonomy`。
- **原因**：在 Eino 的范式里，提供查找/转换/外部交互能力的模块更适合以 Tool 方式存在，便于复用与测试。`submit` 对 taxonomy 的依赖关系保持不变，但通过目录体现其 “工具组件” 的职责。

### 2) 提示词资源（Prompts）管理
- **现状**：`ai/prompts` 位于仓库根目录，缺少与组件边界一致的归类方式。
- **调整后**：迁移为 `internal/components/prompts`（也可视为内部资源目录）。
- **原因**：对应用型项目而言，将核心业务与其依赖资源收敛到 `internal` 便于边界管理；同时可按能力拆分子目录（如 `prompts/risk/`、`prompts/audit/`）提升扩展性与可维护性。

### 3) 数据产物与流水线优化
- **现状**：风险分析阶段输出 `_risk.jsonl` 与 `_results.jsonl`，内容重复。
- **调整后**：移除 `_risk.jsonl` 输出，仅保留实际被下游消费的 results 文件，降低噪音与磁盘占用。

## 权衡
- **迁移成本**：移动目录需要同步更新 import 路径、默认加载路径以及可能的配置项。
- **internal 是否“放太多”**：对 Go 应用项目而言，`internal` 用于约束包不被外部模块 import，是常见最佳实践；将业务逻辑集中在 `internal` 反而能更好地表达边界。对于 prompts 这类资源，如果需要运行时频繁改动，也可以放到外部配置目录；但本次以 “结构严谨与可扩展性” 为主，选择 `internal/components/prompts`，并保留通过环境变量/配置覆盖路径的能力。

## 备选方案
- **保留 `ai/prompts`**：可见性更强，但不符合更严格的目录边界要求。
- **直接删除 taxonomy**：不可行；`submit` 依赖 taxonomy 做 ATT&CK 映射。采用 “迁移并工具化” 的方式，既满足清理旧目录，也保留能力并更贴合 Eino 语义。
